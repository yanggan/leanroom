{% extends "base.html" %}


{%block title%} 课程详情 {%endblock%}


{% block contents %}
    {# 引入宏组件 #}
    {% import 'component.html' as md %}

   

<!-- 顶部的标题组件 -->
    
    <div class="container-fluid course_info_nav">
    
        {# 预留 #}
        <div class="l-user-tools row">
            <div class="container">
                <!-- pass -->
            </div>

            <div class="col s12"></div>
        </div>

        {# 课程信息，操作区域 #}
        {{ md.course_sub_title(course_name=course_data.course_name,img_url=course_data.course_img,course_category=course_data.course_category,course_count=course_data.course_count,course_passwd=passwd_dict,course_size=course_data.course_size)}}

        {# 背景 #}
        <div class="course_info_nav_bk">
            <img class="nav_bk_img" src="/static/img/other/homepage_bk.png" alt="">
        </div>

    </div>


    


    {# 这里是课程表格的组件 #}
    <div class="l-excel row">
        
        <div class="container-fluid">
                

            <table class="highlight bordered">
                <thead>
                    <tr>
                        <th>课程名称</th>
                        <th>更新日期</th>
                        <th>资源链接</th>
                        <th>资源大小</th>
                        <th>提取密码</th>
                    </tr>
                </thead>
                <tbody>
                    {# 需要填充的地方 #}
                    {%for i in course_data.course_data %}
                    <tr>
                        <td>《{{i.resource_name}}》</td>
                        <td>{{i.update_time}}</td>
                        <td><a target="_blank" href="{{i.resource_addr}}">{{i.resource_addr}}</a></td>
                        <td>{{i.resource_size}} G</td>
                        <td>
                            {% if passwd_dict %}
                                <code> {{ passwd_dict.get(i.resource_id) }}  </code>
                            {% else %} 
                                <a class="waves-effect waves-light z-depth-0 small btn grey darken-3" href="#act_modal" >显示提取密码</a>
                            {% endif %}
                        </td>
                    </tr>
                    {%endfor%}
                </tbody>
            </table>

        </div>

    </div>    

    {# 这里是弹出层，输入购买验证码 #}
    <!-- modal内容，输入兑换码 -->
    <div class="remodal" data-remodal-id="act_modal">
        <button data-remodal-action="close" class="remodal-close"></button>
        <!-- 兑换成功的提示 + 兑换时候的表单组，通过是否有passwd_dict来切换 -->
        {% if passwd_dict %} 
            <h5>恭喜您兑换成功</h5>
            <p>
                祝您事业有成,步步高升 <a href="#">前往小店购买更多课程。</a>
            </p>
            <br>
            <button type="submit" data-remodal-action="confirm" class="remodal-confirm">确认</button>

        {% else %} 
            <h5>输入您的兑换码</h5>
            <p>
                输入兑换码获取提取密码,没有兑换码？<a href="#">前往小店购买。</a>
            </p>
            <br>
            <form method="POST" >
                <!-- 这里输入兑换码 -->
                <div class="row">
                    <div class="input-field col s12">
                        <!-- 输入input -->
                        <input name='key' onkeyup="value=value.replace(/[^\d]/g,'')" pattern="[0-9]{4}"   id="first_name2" type="text" class="validate text-center" title="请输入4位数字兑换码">
                        <label class="active text-center " for="first_name2">请输入4位数字兑换码</label>
                        <!-- 新版input -->

                        {% if get_flashed_messages() %}
                        <div class="alert alert-danger" role="alert">兑换失败，您输入的兑换码错误，请重新输入,或请联系客服获取帮助~</div>
                        {% endif %}
                    </div>
                </div>
                <button class="btn actcode_submit  green lighten-1 z-depth-0 waves-effect waves-brown waves-ripple " type="submit"  > 提交验证 </button>
            </form>

        {% endif %}

        
    </div>

    <!-- <a href="#" data-activates="slide-out" class="btn button-collapse">Side nav demo</a> -->

    
    <!-- 消息闪现 -->
<!--     {% for message in get_flashed_messages() %}
        {{message}}
        <a class="btn" onclick="Materialize.toast('flash: {{message}}', 4000)">Toast!</a>
    {%endfor%} -->

    
    <!-- 开发信息展示 -->
    {%if dev_data['flag']%}
    <div class="container l-right-contents">  
        <div class="alert alert-info alert-dismissible" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <strong>课程数据：<br> </strong>
             {{course_data}}<br>
             <strong>密码字典：<br> </strong>
             {{passwd_dict}}

        </div>
    </div>    
    {%endif%}
    
    <!-- 前往店铺购买弹窗 -->
    <ul id="slide-out" class="side-nav">
        <li><div class="user-view">
            <div class="background">
                <img src="/static/img/other/active_course_bk.png">
            </div>
            <a href="#!user"><img class="circle" src="/static/img/other/tips.png"></a>
<!--             <a href="#!name"><span class="white-text name">  -   </span></a>
 -->            <a href="#!email"><span class="white-text"> - 温馨提示 </span></a>
           <!--  <a href="#!name"><span class="white-text name">  -   </span></a> -->

        </div></li>
        <li><a class="subheader">学习步骤</a></li>
        <li><a href="#!"><i class="material-icons">1</i>查看您需要的课程</a></li>
        <li><a href="#!"><i class="material-icons">2</i>前往店铺购买此课程，获取课程兑换码</a></li>
        <li><a href="#!"><i class="material-icons">3</i>在本站兑换课程，获取资源开始学习</a></li>
        <li><div class="divider"></div></li>
        <li><a class="subheader">操作</a></li>
        <li><a class="waves-effect blue-text text-darken-2 " href="#!">去电脑版店铺</a></li>
        <li><a class="waves-effect blue-text text-darken-2 " href="#!">扫码去移动端店铺</a></li>
        <li><img class = "taobao_qc" src="/static/img/other/taobao_qc.png"></a></li>
    </ul>
    
{% endblock %}

